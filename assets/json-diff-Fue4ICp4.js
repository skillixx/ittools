import{b as i,i as a,F as h,l as C,v as O,d as b,n as g,Z as L,ag as $,a as _,g as l,o as v,e as x,f as I,w as V,x as J,c as P,W as Y,ah as z,z as M,D as W,y as Z}from"./index-_gAMuNOu.js";import{l as y}from"./index-A1G9Z81i.js";import{_ as j}from"./Switch-YKugWwD_.js";import{_ as G}from"./FormItem-rgqaL2Lh.js";import{w as A}from"./defaults-wMf-rINs.js";import{i as H}from"./boolean-x-quVNGS.js";import"./use-form-item-5qogMJti.js";function K(e,t,{onlyShowDifferences:s=!1}={}){return i.isArray(e)&&i.isArray(t)?{key:"",type:"array",children:E(e,t,{onlyShowDifferences:s}),oldValue:e,value:t,status:p(e,t)}:i.isObject(e)&&i.isObject(t)?{key:"",type:"object",children:D(e,t,{onlyShowDifferences:s}),oldValue:e,value:t,status:p(e,t)}:{key:"",type:"value",oldValue:e,value:t,status:p(e,t)}}function D(e,t,{onlyShowDifferences:s=!1}={}){return Object.keys({...e,...t}).map(r=>S(e?.[r],t?.[r],r,{onlyShowDifferences:s})).filter(r=>!s||r.status!=="unchanged")}function S(e,t,s,{onlyShowDifferences:n=!1}={}){const r=m(e);return r==="object"?{key:s,type:r,children:D(e,t,{onlyShowDifferences:n}),oldValue:e,value:t,status:p(e,t)}:r==="array"?{key:s,type:r,children:E(e,t,{onlyShowDifferences:n}),value:t,oldValue:e,status:p(e,t)}:{key:s,type:r,value:t,oldValue:e,status:p(e,t)}}function E(e,t,{onlyShowDifferences:s=!1}={}){const n=Math.max(0,e?.length,t?.length);return Array.from({length:n},(r,o)=>S(e?.[o],t?.[o],o,{onlyShowDifferences:s})).filter(r=>!s||r.status!=="unchanged")}function m(e){return e===null?"value":Array.isArray(e)?"array":typeof e=="object"?"object":"value"}function p(e,t){if(e===void 0)return"added";if(t===void 0)return"removed";const s=m(e)==="object"&&m(t)==="object",n=m(e)==="array"&&m(t)==="array";return i.isEqual(e,t)?"unchanged":s||n?"children-updated":"updated"}function Q({diff:e}){return a("div",{class:"diffs-viewer"},[a("ul",null,[R({diff:e,showKeys:!1})])])}function R({diff:e,showKeys:t=!0}){const{type:s,status:n}=e;return n==="updated"?w({diff:e,showKeys:t}):s==="array"?T({diff:e,showKeys:t,showChildrenKeys:!1,openTag:"[",closeTag:"]"}):s==="object"?T({diff:e,showKeys:t,openTag:"{",closeTag:"}"}):X({diff:e,showKeys:t})}function X({diff:e,showKeys:t}){const{value:s,key:n,status:r,oldValue:o}=e,u=r==="removed"?o:s;return a("li",null,[a("span",{class:[r,"result"]},[t&&a(h,null,[a("span",{class:"key"},[n]),": "]),k({value:u,status:r})]),C(",")])}function w({diff:e,showKeys:t}){const{value:s,key:n,oldValue:r}=e;return a("li",{class:"updated-line"},[t&&a(h,null,[a("span",{class:"key"},[n]),": "]),k({value:r,status:"removed"}),k({value:s,status:"added"}),C(",")])}function T({diff:e,openTag:t,closeTag:s,showKeys:n,showChildrenKeys:r=!0}){const{children:o,key:u,status:c,type:d}=e;return a("li",null,[a("div",{class:[d,c],style:{display:"inline-block"}},[n&&a(h,null,[a("span",{class:"key"},[u]),": "]),t,o.length>0&&a("ul",null,[o.map(f=>R({diff:f,showKeys:r}))]),`${s},`])])}function ee(e){return i.isNull(e)?"null":JSON.stringify(e)}function k({value:e,status:t}){const s=ee(e),{copy:n}=O({source:s});return a("span",{class:["value",t],onClick:()=>n()},[s])}const te={key:0},se={flex:"","justify-center":""},re={key:0,"text-center":"","op-70":""},ne=b({__name:"diff-viewer",props:{leftJson:{},rightJson:{}},setup(e){z(f=>({"3f5a237b":l(o).text.mutedColor,bd8dc824:l(o).success.colorFaded,"41a944cc":l(o).success.color,"5fbb776e":l(o).error.colorFaded,"5689af42":l(o).error.color,"259543ef":l(o).text.baseColor}));const t=e,s=g(!1),{leftJson:n,rightJson:r}=L(t),o=$(),u=_(()=>K(n.value,r.value,{onlyShowDifferences:s.value})),c=_(()=>i.isEqual(n.value,r.value)),d=_(()=>!i.isUndefined(n.value)&&!i.isUndefined(r.value));return(f,N)=>{const U=j,q=G,B=M;return l(d)?(v(),x("div",te,[I("div",se,[a(q,{label:"Only show differences","label-placement":"left"},{default:V(()=>[a(U,{value:l(s),"onUpdate:value":N[0]||(N[0]=F=>J(s)?s.value=F:null)},null,8,["value"])]),_:1})]),a(B,{"data-test-id":"diff-result"},{default:V(()=>[l(c)?(v(),x("div",re," The provided JSONs are the same ")):(v(),P(l(Q),{key:1,diff:l(u)},null,8,["diff"]))]),_:1})])):Y("",!0)}}}),ae=W(ne,[["__scopeId","data-v-0dfca55b"]]),pe=b({__name:"json-diff",setup(e){const t=g(""),s=g(""),n=_(()=>A(()=>y.parse(t.value),void 0)),r=_(()=>A(()=>y.parse(s.value),void 0)),o=[{validator:u=>u===""||H(()=>y.parse(u)),message:"Invalid JSON format"}];return(u,c)=>{const d=Z;return v(),x(h,null,[a(d,{value:l(t),"onUpdate:value":c[0]||(c[0]=f=>J(t)?t.value=f:null),"validation-rules":o,label:"Your first JSON",placeholder:"Paste your first JSON here...",rows:"20",multiline:"","test-id":"leftJson","raw-text":"",monospace:""},null,8,["value"]),a(d,{value:l(s),"onUpdate:value":c[1]||(c[1]=f=>J(s)?s.value=f:null),"validation-rules":o,label:"Your JSON to compare",placeholder:"Paste your JSON to compare here...",rows:"20",multiline:"","test-id":"rightJson","raw-text":"",monospace:""},null,8,["value"]),a(ae,{"left-json":l(n),"right-json":l(r)},null,8,["left-json","right-json"])],64)}}});export{pe as default};
